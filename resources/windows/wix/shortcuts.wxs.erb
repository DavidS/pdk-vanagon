<?xml version='1.0' encoding='windows-1252'?>
<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi' xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
  <!--
    Puppet Development Kit specific shortcut config
    This overrides the generic file in the vanagon directory
  -->
  <Fragment>
    <!-- These shortcuts will be created in the INSTALLDIR/bin directory -->
    <DirectoryRef Id='INSTALLDIR'>
      <Directory Id="ShortCutBinDir" Name="bin">
      </Directory>
    </DirectoryRef>

    <!-- Directory Definitions for Start Menu Shortcuts -->
    <DirectoryRef Id='TARGETDIR'>
      <Directory Id='ProgramMenuFolder'>
        <Directory Id='PuppetSDKShortcutDir' Name="<%= settings[:shortcut_name] %>">
          <Directory Id='PuppetSDKShortcutDocumentationDir' Name="Documentation">
          </Directory>
        </Directory>
      </Directory>
    </DirectoryRef>

    <ComponentGroup Id="ShortCutsComponentGroup">
      <Component
        Id="PuppetSDKShortcuts"
        Guid="748E4EFE-73CB-4519-9697-53A994F2EDE3"
        Directory="PuppetSDKShortcutDir"
        Win64="<%= settings[:win64] %>">
        <Shortcut
          Id="PuppetSDKShortcut"
          Name="Puppet Development Kit Console"
          Description="Start a Command Prompt with Puppet Development Kit already in the PATH and RUBYLIB load path."
          Target="[%ComSpec]"
          Arguments='/E:ON /K "[INSTALLDIR]bin\pdk_shell.bat"'
          Icon="PuppetSDKShellShortcutIcon"
          WorkingDirectory="bin">
          <Icon
            Id="PuppetSDKShellShortcutIcon"
            SourceFile="wix\icon\puppet.ico"/>
        </Shortcut>
        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall"/>
        <RegistryValue
          Root="HKCU"
          Key="SOFTWARE\<%= settings[:pl_company_name] %>\<%= settings[:product_id] %>"
          Name="installed"
          Value="1"
          Type="integer"
          KeyPath="yes" />
      </Component>

      <Component
        Id="PuppetSDKDocumentationShortcuts"
        Guid="616ECAD8-52E7-4DA2-A60C-DE6F11A90E16"
        Directory="PuppetSDKShortcutDocumentationDir"
        Win64="<%= settings[:win64] %>">
        <IniFile
          Id="PuppetSDKSupportURL"
          Name="Get <%= settings[:product_name] %> Support.url"
          Action="addLine"
          Section="InternetShortcut"
          Key="URL"
          Value="<%= settings[:links][:HelpLink] %>"
          Directory="PuppetSDKShortcutDocumentationDir" />
        <RemoveFolder
          Id="PuppetSDKShortcutDocumentationDir"
          On="uninstall"/>
        <RegistryValue
          Root="HKCU"
          Key="SOFTWARE\<%= settings[:pl_company_name] %>\<%= settings[:product_id] %>\Documentation"
          Name="installed"
          Value="1"
          Type="integer"
          KeyPath="yes" />
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix>
